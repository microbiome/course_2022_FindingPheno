<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Microbiome data exploration | Introduction to multi-omics data analysis</title>
  <meta name="description" content="Workshop material" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Microbiome data exploration | Introduction to multi-omics data analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Workshop material" />
  <meta name="github-repo" content="microbiome/course_2022_FindingPheno" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Microbiome data exploration | Introduction to multi-omics data analysis" />
  
  <meta name="twitter:description" content="Workshop material" />
  

<meta name="author" content="University of Turku" />


<meta name="date" content="2022-01-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="beta-diversity.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to multiomic data analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#learning-goals-to-do"><i class="fa fa-check"></i><b>1.2</b> Learning goals [TO DO]</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>1.3</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="program.html"><a href="program.html"><i class="fa fa-check"></i><b>2</b> Program</a>
<ul>
<li class="chapter" data-level="2.1" data-path="program.html"><a href="program.html#day-1"><i class="fa fa-check"></i><b>2.1</b> Day 1</a></li>
<li class="chapter" data-level="2.2" data-path="program.html"><a href="program.html#day-2"><i class="fa fa-check"></i><b>2.2</b> Day 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting started</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#checklist-before-the-workshop"><i class="fa fa-check"></i><b>3.1</b> Checklist (before the workshop)</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started.html"><a href="getting-started.html#support-and-resources"><i class="fa fa-check"></i><b>3.2</b> Support and resources</a></li>
<li class="chapter" data-level="3.3" data-path="getting-started.html"><a href="getting-started.html#installing-and-loading-the-required-r-packages"><i class="fa fa-check"></i><b>3.3</b> Installing and loading the required R packages</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#data-structure"><i class="fa fa-check"></i><b>4.1</b> Data structure</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#example-data"><i class="fa fa-check"></i><b>4.2</b> Example data</a></li>
<li class="chapter" data-level="4.3" data-path="data.html"><a href="data.html#importing-data-in-r"><i class="fa fa-check"></i><b>4.3</b> Importing data in R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html"><i class="fa fa-check"></i><b>5</b> Microbiome data exploration</a>
<ul>
<li class="chapter" data-level="5.1" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#data-structure-1"><i class="fa fa-check"></i><b>5.1</b> Data structure</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#transformations"><i class="fa fa-check"></i><b>5.1.1</b> Transformations</a></li>
<li class="chapter" data-level="5.1.2" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#aggregation"><i class="fa fa-check"></i><b>5.1.2</b> Aggregation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="microbiome-data-exploration.html"><a href="microbiome-data-exploration.html#visualization"><i class="fa fa-check"></i><b>5.2</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="beta-diversity.html"><a href="beta-diversity.html"><i class="fa fa-check"></i><b>6</b> Beta diversity</a>
<ul>
<li class="chapter" data-level="6.1" data-path="beta-diversity.html"><a href="beta-diversity.html#examples-of-pcoa-with-different-settings"><i class="fa fa-check"></i><b>6.1</b> Examples of PCoA with different settings</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="beta-diversity.html"><a href="beta-diversity.html#pcoa-for-asv-level-data-with-bray-curtis"><i class="fa fa-check"></i><b>6.1.1</b> PCoA for ASV-level data with Bray-Curtis</a></li>
<li class="chapter" data-level="6.1.2" data-path="beta-diversity.html"><a href="beta-diversity.html#pcoa-for-asv-level-data-with-aitchison-distance"><i class="fa fa-check"></i><b>6.1.2</b> PCoA for ASV-level data with Aitchison distance</a></li>
<li class="chapter" data-level="6.1.3" data-path="beta-diversity.html"><a href="beta-diversity.html#pcoa-aggregated-to-phylum-level"><i class="fa fa-check"></i><b>6.1.3</b> PCoA aggregated to Phylum level</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="beta-diversity.html"><a href="beta-diversity.html#highlighting-external-variables"><i class="fa fa-check"></i><b>6.2</b> Highlighting external variables</a></li>
<li class="chapter" data-level="6.3" data-path="beta-diversity.html"><a href="beta-diversity.html#estimating-associations-with-an-external-variable"><i class="fa fa-check"></i><b>6.3</b> Estimating associations with an external variable</a></li>
<li class="chapter" data-level="6.4" data-path="beta-diversity.html"><a href="beta-diversity.html#community-typing"><i class="fa fa-check"></i><b>6.4</b> Community typing</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html"><i class="fa fa-check"></i><b>7</b> Unsupervised learning</a>
<ul>
<li class="chapter" data-level="7.1" data-path="unsupervised-learning.html"><a href="unsupervised-learning.html#biclustering"><i class="fa fa-check"></i><b>7.1</b> Biclustering</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>8</b> Supervised learning</a>
<ul>
<li class="chapter" data-level="8.1" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forests"><i class="fa fa-check"></i><b>8.1</b> Random Forests</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-selection-and-evaluation.html"><a href="model-selection-and-evaluation.html"><i class="fa fa-check"></i><b>9</b> Model selection and evaluation</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to multi-omics data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="microbiome-data-exploration" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Microbiome data exploration</h1>
<p>Now we have loaded the data set into R. Next, let us walk through some
basic operations for data exploration to confirm that the data has all
the necessary components.</p>
<div id="data-structure-1" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Data structure</h2>
<p>Let us now investigate how taxonomic profiling data is organized in R.</p>
<p>Dimensionality tells us how many taxa and samples the data
contains. As we can see, there are 12613 taxa and 40
samples.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="microbiome-data-exploration.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mae[[1]]: indexing/retrieving the taxonomic data experiment</span></span>
<span id="cb8-2"><a href="microbiome-data-exploration.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mae[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## [1] 12613    40</code></pre>
<p>The <code>rowData</code> slot contains a taxonomic table. This includes taxonomic
information for each of the 12613 entries. With the <code>head()</code>
command, we can print just the beginning of the table.</p>
<p>The <code>rowData</code> seems to contain information from 7
different taxonomy classes.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="microbiome-data-exploration.html#cb10-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(<span class="fu">rowData</span>(mae[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="microbiome-data-exploration.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, </span>
<span id="cb10-3"><a href="microbiome-data-exploration.html#cb10-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">latex_options=</span><span class="st">&quot;scale_down&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="microbiome-data-exploration.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Phylum
</th>
<th style="text-align:left;">
Class
</th>
<th style="text-align:left;">
Order
</th>
<th style="text-align:left;">
Family
</th>
<th style="text-align:left;">
Genus
</th>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
OTU
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
GAYR01026362.62.2014
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Alphaproteobacteria
</td>
<td style="text-align:left;">
Rickettsiales
</td>
<td style="text-align:left;">
Mitochondria
</td>
<td style="text-align:left;">
Solanum melongena (eggplant)
</td>
<td style="text-align:left;">
Solanum melongena (eggplant)
</td>
<td style="text-align:left;">
GAYR01026362.62.2014
</td>
</tr>
<tr>
<td style="text-align:left;">
CVJT01000011.50.2173
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Bacillales
</td>
<td style="text-align:left;">
Staphylococcaceae
</td>
<td style="text-align:left;">
Staphylococcus
</td>
<td style="text-align:left;">
Staphylococcus aureus
</td>
<td style="text-align:left;">
CVJT01000011.50.2173
</td>
</tr>
<tr>
<td style="text-align:left;">
KF625183.1.1786
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Gammaproteobacteria
</td>
<td style="text-align:left;">
Enterobacteriales
</td>
<td style="text-align:left;">
Enterobacteriaceae
</td>
<td style="text-align:left;">
Klebsiella
</td>
<td style="text-align:left;">
Klebsiella oxytoca
</td>
<td style="text-align:left;">
KF625183.1.1786
</td>
</tr>
<tr>
<td style="text-align:left;">
AYSG01000002.292.2076
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Lactobacillales
</td>
<td style="text-align:left;">
Streptococcaceae
</td>
<td style="text-align:left;">
Streptococcus
</td>
<td style="text-align:left;">
Streptococcus thermophilus TH1435
</td>
<td style="text-align:left;">
AYSG01000002.292.2076
</td>
</tr>
<tr>
<td style="text-align:left;">
CCPS01000022.154.1916
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Gammaproteobacteria
</td>
<td style="text-align:left;">
Enterobacteriales
</td>
<td style="text-align:left;">
Enterobacteriaceae
</td>
<td style="text-align:left;">
Escherichia-Shigella
</td>
<td style="text-align:left;">
Escherichia coli
</td>
<td style="text-align:left;">
CCPS01000022.154.1916
</td>
</tr>
<tr>
<td style="text-align:left;">
KJ923794.1.1762
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Bacilli
</td>
<td style="text-align:left;">
Bacillales
</td>
<td style="text-align:left;">
Staphylococcaceae
</td>
<td style="text-align:left;">
Staphylococcus
</td>
<td style="text-align:left;">
Staphylococcus aureus
</td>
<td style="text-align:left;">
KJ923794.1.1762
</td>
</tr>
</tbody>
</table>
</div>
<p>The colData slot contains sample metadata. It contains information for all 40 samples.
However, here only the 6 first samples are shown as we use the <code>head()</code> command. There
are 6 columns, that contain information, e.g., about patients’ status, and cohort.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="microbiome-data-exploration.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For simplicity, classify all high-fat diets as high-fat, and all the low-fat </span></span>
<span id="cb11-2"><a href="microbiome-data-exploration.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># diets as low-fat diets</span></span>
<span id="cb11-3"><a href="microbiome-data-exploration.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colData</span>(mae)<span class="sc">$</span>Diet <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>Diet <span class="sc">==</span> <span class="st">&quot;High-fat&quot;</span> <span class="sc">|</span> </span>
<span id="cb11-4"><a href="microbiome-data-exploration.html#cb11-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">colData</span>(mae)<span class="sc">$</span>Diet <span class="sc">==</span> <span class="st">&quot;High-fat + XOS&quot;</span>, </span>
<span id="cb11-5"><a href="microbiome-data-exploration.html#cb11-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;High-fat&quot;</span>, <span class="st">&quot;Low-fat&quot;</span>)</span>
<span id="cb11-6"><a href="microbiome-data-exploration.html#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="microbiome-data-exploration.html#cb11-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(<span class="fu">colData</span>(mae))) <span class="sc">%&gt;%</span> </span>
<span id="cb11-8"><a href="microbiome-data-exploration.html#cb11-8" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, </span>
<span id="cb11-9"><a href="microbiome-data-exploration.html#cb11-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">latex_options=</span><span class="st">&quot;scale_down&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-10"><a href="microbiome-data-exploration.html#cb11-10" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Sample
</th>
<th style="text-align:left;">
Rat
</th>
<th style="text-align:left;">
Site
</th>
<th style="text-align:left;">
Diet
</th>
<th style="text-align:left;">
Fat
</th>
<th style="text-align:right;">
XOS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C1
</td>
<td style="text-align:left;">
C1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Cecum
</td>
<td style="text-align:left;">
High-fat
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
C2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Cecum
</td>
<td style="text-align:left;">
High-fat
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Cecum
</td>
<td style="text-align:left;">
High-fat
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
C4
</td>
<td style="text-align:left;">
C4
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Cecum
</td>
<td style="text-align:left;">
High-fat
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
C5
</td>
<td style="text-align:left;">
C5
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Cecum
</td>
<td style="text-align:left;">
High-fat
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
C6
</td>
<td style="text-align:left;">
C6
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
Cecum
</td>
<td style="text-align:left;">
High-fat
</td>
<td style="text-align:left;">
High
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<p>From here, we can draw summaries of the sample (column) data, for
instance to see what is the diet distribution.</p>
<p>The command <code>colData(mae)$Diet</code> fetches the data from the
column, and <code>table()</code> creates a table that shows how many times each
class is present, and <code>sort()</code> sorts the table to ascending order.</p>
<p>There are 20
samples from mice having High-fat,
and 20 Low-fat.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="microbiome-data-exploration.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">table</span>(<span class="fu">colData</span>(mae)<span class="sc">$</span>Diet))</span></code></pre></div>
<pre><code>## 
## High-fat  Low-fat 
##       20       20</code></pre>
<div id="transformations" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Transformations</h3>
<p>Microbial abundances are typically ‘compositional’ (relative) in the
current microbiome profiling data sets. This is due to technical
aspects of the data generation process (see e.g. <a href="https://www.frontiersin.org/articles/10.3389/fmicb.2017.02224/full">Gloor et al.,
2017</a>).</p>
<p>The next example calculates relative abundances as these are usually easier to
interpret than plain counts. For some statistical models we need to
transform the data into other formats as explained in above link (and
as we will see later).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="microbiome-data-exploration.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculates relative abundances, and stores the table to assays</span></span>
<span id="cb14-2"><a href="microbiome-data-exploration.html#cb14-2" aria-hidden="true" tabindex="-1"></a>mae[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">transformCounts</span>(mae[[<span class="dv">1</span>]], <span class="at">method =</span> <span class="st">&quot;relabundance&quot;</span>)</span></code></pre></div>
<p>A variety of standard transformations for microbiome data are available through <a href="https://microbiome.github.io/mia/reference/transformCounts.html">mia R package</a>.</p>
</div>
<div id="aggregation" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Aggregation</h3>
<p>Microbial species can be called at multiple taxonomic resolutions. We
can easily agglomerate the data based on taxonomic ranks. Here, we
agglomerate the data at Phylum level.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="microbiome-data-exploration.html#cb15-1" aria-hidden="true" tabindex="-1"></a>se_phylum <span class="ot">&lt;-</span> <span class="fu">agglomerateByRank</span>(mae[[<span class="dv">1</span>]], <span class="at">rank =</span> <span class="st">&quot;Phylum&quot;</span>)</span>
<span id="cb15-2"><a href="microbiome-data-exploration.html#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="microbiome-data-exploration.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Show dimensionality</span></span>
<span id="cb15-4"><a href="microbiome-data-exploration.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(se_phylum)</span></code></pre></div>
<pre><code>## [1] 13 40</code></pre>
<p>Now there are 13 taxa and 40
samples, meaning that there are 13 different
Phylum level taxonomic groups. Looking at the <code>rowData</code> after
agglomeration shows all Firmicutes are combined together, and all
lower rank information is lost.</p>
<p>From the assay we can see that all abundances of taxa that belong to
Firmicutes are summed up.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="microbiome-data-exploration.html#cb17-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(<span class="fu">rowData</span>(se_phylum))) <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="microbiome-data-exploration.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, </span>
<span id="cb17-3"><a href="microbiome-data-exploration.html#cb17-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">latex_options=</span><span class="st">&quot;scale_down&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="microbiome-data-exploration.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Phylum
</th>
<th style="text-align:left;">
Class
</th>
<th style="text-align:left;">
Order
</th>
<th style="text-align:left;">
Family
</th>
<th style="text-align:left;">
Genus
</th>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
OTU
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
GAYR01026362.62.2014
</td>
</tr>
<tr>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
CVJT01000011.50.2173
</td>
</tr>
<tr>
<td style="text-align:left;">
Cyanobacteria
</td>
<td style="text-align:left;">
Cyanobacteria
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
GEMN01027092.33.1623
</td>
</tr>
<tr>
<td style="text-align:left;">
Tenericutes
</td>
<td style="text-align:left;">
Tenericutes
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
AM277369.1.1548
</td>
</tr>
<tr>
<td style="text-align:left;">
Deferribacteres
</td>
<td style="text-align:left;">
Deferribacteres
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
AYGZ01000001.327.1863
</td>
</tr>
<tr>
<td style="text-align:left;">
Actinobacteria
</td>
<td style="text-align:left;">
Actinobacteria
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
JGZF01000005.1.1534
</td>
</tr>
</tbody>
</table>
</div>
<p>If you are sharp, you have by now noticed that all the aggregated
values in the above example are NA’s (missing data). This is because
the agglomeration is missing abundances for certain taxa, and in that
case the sum is not defined by default (<code>na.rm = FALSE</code>). We can
ignore the missing values in summing up the data by setting <code>na.rm = TRUE</code>; then the taxa that do not have information in specified level
will be removed. Those taxa that do not have information in specified
level are agglomerated at lowest possible level that is left after
agglomeration.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="microbiome-data-exploration.html#cb18-1" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">rowData</span>(<span class="fu">agglomerateByRank</span>(mae[[<span class="dv">1</span>]], <span class="at">rank =</span> <span class="st">&quot;Genus&quot;</span>))</span>
<span id="cb18-2"><a href="microbiome-data-exploration.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="microbiome-data-exploration.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prints those taxa that do not have information at the Genus level (NA)</span></span>
<span id="cb18-4"><a href="microbiome-data-exploration.html#cb18-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(temp[<span class="fu">which</span>(<span class="fu">is.na</span>(temp<span class="sc">$</span>Genus)),])) <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="microbiome-data-exploration.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="st">&quot;striped&quot;</span>, </span>
<span id="cb18-6"><a href="microbiome-data-exploration.html#cb18-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">latex_options=</span><span class="st">&quot;scale_down&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="microbiome-data-exploration.html#cb18-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">width =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Phylum
</th>
<th style="text-align:left;">
Class
</th>
<th style="text-align:left;">
Order
</th>
<th style="text-align:left;">
Family
</th>
<th style="text-align:left;">
Genus
</th>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
OTU
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Family:uncultured
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Alphaproteobacteria
</td>
<td style="text-align:left;">
Rhodospirillales
</td>
<td style="text-align:left;">
uncultured
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
JRJTB:01000:00983
</td>
</tr>
<tr>
<td style="text-align:left;">
Family:Ruminococcaceae
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Clostridia
</td>
<td style="text-align:left;">
Clostridiales
</td>
<td style="text-align:left;">
Ruminococcaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
JRJTB:00751:00256
</td>
</tr>
<tr>
<td style="text-align:left;">
Order:Clostridiales
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Clostridia
</td>
<td style="text-align:left;">
Clostridiales
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
JRJTB:03059:01977
</td>
</tr>
<tr>
<td style="text-align:left;">
Family:Lachnospiraceae
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Clostridia
</td>
<td style="text-align:left;">
Clostridiales
</td>
<td style="text-align:left;">
Lachnospiraceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
JRJTB:00738:02832
</td>
</tr>
<tr>
<td style="text-align:left;">
Family:Peptostreptococcaceae
</td>
<td style="text-align:left;">
Firmicutes
</td>
<td style="text-align:left;">
Clostridia
</td>
<td style="text-align:left;">
Clostridiales
</td>
<td style="text-align:left;">
Peptostreptococcaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
JRJTB:01731:00274
</td>
</tr>
<tr>
<td style="text-align:left;">
Family:Pasteurellaceae
</td>
<td style="text-align:left;">
Proteobacteria
</td>
<td style="text-align:left;">
Gammaproteobacteria
</td>
<td style="text-align:left;">
Pasteurellales
</td>
<td style="text-align:left;">
Pasteurellaceae
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
JRJTB:01960:01703
</td>
</tr>
</tbody>
</table>
</div>
<p>Here agglomeration is done similarly, but na.rm = TRUE</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="microbiome-data-exploration.html#cb19-1" aria-hidden="true" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> <span class="fu">rowData</span>(<span class="fu">agglomerateByRank</span>(mae[[<span class="dv">1</span>]], <span class="at">rank =</span> <span class="st">&quot;Genus&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb19-2"><a href="microbiome-data-exploration.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="microbiome-data-exploration.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Agglomeration with na.rm = FALSE: &quot;</span>, <span class="fu">dim</span>(temp)[<span class="dv">1</span>], <span class="st">&quot; taxa.&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Agglomeration with na.rm = FALSE: 277 taxa.&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="microbiome-data-exploration.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Agglomeration with na.rm = TRUE: &quot;</span>, <span class="fu">dim</span>(temp2)[<span class="dv">1</span>], <span class="st">&quot; taxa.&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Agglomeration with na.rm = TRUE: 262 taxa.&quot;</code></pre>
<p>The <a href="https://microbiome.github.io/mia/reference/index.html">mia
package</a>
contains further examples on various data agglomeration and splitting
options.</p>
</div>
</div>
<div id="visualization" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Visualization</h2>
<p>The <a href="https://microbiome.github.io/miaViz/">miaViz package</a> facilitates
data visualization. Let us plot the Phylum level abundances.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="microbiome-data-exploration.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we specify &quot;relabundance&quot; to be abundance table that we use for plotting.</span></span>
<span id="cb23-2"><a href="microbiome-data-exploration.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that we can use agglomerated or non-agglomerated mae[[1]] as an input, because</span></span>
<span id="cb23-3"><a href="microbiome-data-exploration.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the function agglomeration is built-in option. </span></span>
<span id="cb23-4"><a href="microbiome-data-exploration.html#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="microbiome-data-exploration.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend does not fit into picture, so its height is reduced.</span></span>
<span id="cb23-6"><a href="microbiome-data-exploration.html#cb23-6" aria-hidden="true" tabindex="-1"></a>plot_abundance <span class="ot">&lt;-</span> <span class="fu">plotAbundance</span>(mae[[<span class="dv">1</span>]], <span class="at">abund_values=</span><span class="st">&quot;relabundance&quot;</span>, <span class="at">rank =</span> <span class="st">&quot;Phylum&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="microbiome-data-exploration.html#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb23-8"><a href="microbiome-data-exploration.html#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>percent)</span>
<span id="cb23-9"><a href="microbiome-data-exploration.html#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="microbiome-data-exploration.html#cb23-10" aria-hidden="true" tabindex="-1"></a>plot_abundance </span></code></pre></div>
<p><img src="04-explore_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p><strong>Density plot</strong> shows the overall abundance distribution for a given
taxonomic group. Let us check the relative abundance of Firmicutes
across the sample collection. The density plot is a smoothened
version of a standard histogram.</p>
<p>The plot shows peak abundances around 30 %.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="microbiome-data-exploration.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset data by taking only Firmicutes</span></span>
<span id="cb24-2"><a href="microbiome-data-exploration.html#cb24-2" aria-hidden="true" tabindex="-1"></a>se_firmicutes <span class="ot">&lt;-</span> se_phylum[<span class="st">&quot;Firmicutes&quot;</span>]</span>
<span id="cb24-3"><a href="microbiome-data-exploration.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="microbiome-data-exploration.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gets the abundance table</span></span>
<span id="cb24-5"><a href="microbiome-data-exploration.html#cb24-5" aria-hidden="true" tabindex="-1"></a>abundance_firmicutes <span class="ot">&lt;-</span> <span class="fu">assay</span>(se_firmicutes, <span class="st">&quot;relabundance&quot;</span>)</span>
<span id="cb24-6"><a href="microbiome-data-exploration.html#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="microbiome-data-exploration.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates a data frame object, where first column includes abundances</span></span>
<span id="cb24-8"><a href="microbiome-data-exploration.html#cb24-8" aria-hidden="true" tabindex="-1"></a>firmicutes_abund_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(abundance_firmicutes))</span>
<span id="cb24-9"><a href="microbiome-data-exploration.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the first and only column</span></span>
<span id="cb24-10"><a href="microbiome-data-exploration.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(firmicutes_abund_df) <span class="ot">&lt;-</span> <span class="st">&quot;abund&quot;</span></span>
<span id="cb24-11"><a href="microbiome-data-exploration.html#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="microbiome-data-exploration.html#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates a plot. Parameters inside feom_density are optional. With </span></span>
<span id="cb24-13"><a href="microbiome-data-exploration.html#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_density(bw=1000), it is possible to adjust bandwidth.</span></span>
<span id="cb24-14"><a href="microbiome-data-exploration.html#cb24-14" aria-hidden="true" tabindex="-1"></a>firmicutes_abund_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(firmicutes_abund_df, <span class="fu">aes</span>(<span class="at">x =</span> abund)) <span class="sc">+</span> </span>
<span id="cb24-15"><a href="microbiome-data-exploration.html#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-16"><a href="microbiome-data-exploration.html#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Relative abundance&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Firmicutes&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-17"><a href="microbiome-data-exploration.html#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co"># Changes the background</span></span>
<span id="cb24-18"><a href="microbiome-data-exploration.html#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>percent)</span>
<span id="cb24-19"><a href="microbiome-data-exploration.html#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="microbiome-data-exploration.html#cb24-20" aria-hidden="true" tabindex="-1"></a>firmicutes_abund_plot</span></code></pre></div>
<p><img src="04-explore_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>For more visualization options and examples, see the <a href="https://microbiome.github.io/miaViz/articles/miaViz.html">miaViz vignette</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="beta-diversity.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["FindingPheno2022_material.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
